<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Recibir Datos</title>
  <script src="https://unpkg.com/paho-mqtt/mqttws31.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #labelRecibido { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

  <h2>Recibir Datos</h2>

  <div id="labelRecibido">Esperando mensaje...</div>

  <script>
    const TOKEN = "lwsQrY5Fd5EojF6RGubjOtHxQML4P9VmaYyLXeUG74VANy7Itn8W5GSVdnZurODR";  // 🔐 Tu token
    const TOPIC = "juan23/chat";  // 🧵 El mismo topic

    const client = new Paho.MQTT.Client("mqtt.flespi.io", 443, "cliente-" + Math.random());

    client.onMessageArrived = (msg) => {
      document.getElementById("labelRecibido").textContent = "Recibido: " + msg.payloadString;
    };

    client.onConnectionLost = (e) => {
      console.log("Conexión perdida:", e.errorMessage);
    };

    client.connect({
      useSSL: true,
      userName: TOKEN,
      password: "",
      onSuccess: () => {
        console.log("Conectado");
        client.subscribe(TOPIC);
      },
      onFailure: (e) => {
        console.log("Error al conectar:", e.errorMessage);
      }
    });
  </script>

</body>
</html>
