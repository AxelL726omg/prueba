<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Enviar Datos</title>
  <script src="https://unpkg.com/paho-mqtt/mqttws31.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, button { padding: 10px; font-size: 16px; }
  </style>
</head>
<body>

  <h2>Enviar Datos</h2>
  
  <input type="text" id="texto" placeholder="EscribÃ­ algo" />
  <button onclick="enviar()">Enviar</button>

  <script>
    const TOKEN = "lwsQrY5Fd5EojF6RGubjOtHxQML4P9VmaYyLXeUG74VANy7Itn8W5GSVdnZurODR";  // ðŸ” Tu token
    const TOPIC = "juan23/chat";  // ðŸ§µ El mismo topic

    const client = new Paho.MQTT.Client("mqtt.flespi.io", 443, "cliente-" + Math.random());

    client.onConnectionLost = (e) => {
      console.log("ConexiÃ³n perdida:", e.errorMessage);
    };

    client.connect({
      useSSL: true,
      userName: TOKEN,
      password: "",
      onSuccess: () => {
        console.log("Conectado");
      },
      onFailure: (e) => {
        console.log("Error al conectar:", e.errorMessage);
      }
    });

    function enviar() {
      const texto = document.getElementById("texto").value;
      if (texto) {
        const msg = new Paho.MQTT.Message(texto);
        msg.destinationName = TOPIC;
        client.send(msg);
        console.log("Mensaje enviado: " + texto);
      }
    }
  </script>

</body>
</html>
